<!DOCTYPE html>
<html lang="da">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin - LYDSTYRKEN</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #000;
      color: #fff;
      margin: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }
    .container {
      background: #111;
      padding: 20px;
      border-radius: 10px;
      width: 90%;
      max-width: 700px;
    }
    h1 { color: #00ff66; }
    ul { list-style: none; padding: 0; }
    li { margin-bottom: 15px; }
    button {
      padding: 5px 10px;
      background: #ff4444;
      border: none;
      color: #fff;
      border-radius: 4px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Admin panel</h1>
    <ul id="userList"></ul>
    <button id="logoutBtn">Log ud</button>
  </div>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-app.js";
    import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-auth.js";
    import { getFirestore, collection, getDocs, doc, deleteDoc, getDoc } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCyKtFD4BrFjKGtPGy2cKPenkysz4h2lLI",
      authDomain: "lydstyrken-ab288.firebaseapp.com",
      projectId: "lydstyrken-ab288",
      storageBucket: "lydstyrken-ab288.appspot.com",
      messagingSenderId: "140962566931",
      appId: "1:140962566931:web:b7f4ababaf3184bc8cc0e6",
      measurementId: "G-Q74KMFN9YV"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    onAuthStateChanged(auth, async (user) => {
      if (!user || user.email !== "lydstyrken.admin") {
        window.location.href = "index.html";
        return;
      }
      const snap = await getDocs(collection(db, "users"));
      const list = document.getElementById("userList");
      for (const docSnap of snap.docs) {
        const data = docSnap.data();
        const li = document.createElement("li");
        li.innerHTML = `<strong>${data.email}</strong> - nyhedsbrev: ${data.newsletter ? "ja" : "nej"} <button data-id="${docSnap.id}">Slet</button><ul id="orders-${docSnap.id}"></ul>`;
        list.appendChild(li);
        const ordersSnap = await getDocs(collection(db, "users", docSnap.id, "orders"));
        const ordersUl = document.getElementById(`orders-${docSnap.id}`);
        ordersSnap.forEach((o) => {
          const orderLi = document.createElement("li");
          orderLi.textContent = `${o.id} - ${o.data().item || ""}`;
          ordersUl.appendChild(orderLi);
        });
        li.querySelector("button").addEventListener("click", async (e) => {
          await deleteDoc(doc(db, "users", e.target.dataset.id));
          li.remove();
        });
      }
    });

    document.getElementById("logoutBtn").addEventListener("click", () => {
      signOut(auth).then(() => {
        localStorage.removeItem("lydstyrkenUser");
        window.location.href = "index.html";
      });
    });
  </script>
<!-- /assets/js/firebase.js -->
<script type="module">
  // 1) Indsæt din egen config herfra Firebase Console
import { initializeApp } from "firebase/app";
import { getAnalytics } from "firebase/analytics";
// TODO: Add SDKs for Firebase products that you want to use
// https://firebase.google.com/docs/web/setup#available-libraries

// Your web app's Firebase configuration
// For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyCyKtFD4BrFjKGtPGy2cKPenkysz4h2lLI",
  authDomain: "lydstyrken-ab288.firebaseapp.com",
  projectId: "lydstyrken-ab288",
  storageBucket: "lydstyrken-ab288.firebasestorage.app",
  messagingSenderId: "140962566931",
  appId: "1:140962566931:web:b7f4ababaf3184bc8cc0e6",
  measurementId: "G-Q74KMFN9YV"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const analytics = getAnalytics(app);

  // 2) Firebase SDK (v10) – CDN
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
  import { 
    getAuth, onAuthStateChanged, 
    signInWithEmailAndPassword, createUserWithEmailAndPassword, 
    sendPasswordResetEmail, signOut 
  } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
  import { 
    getFirestore, doc, getDoc, setDoc 
  } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

  // 3) Init
  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  // 4) Gør let tilgængeligt globalt (enkelt projekt)
  window._fb = { app, auth, db, 
    onAuthStateChanged, signInWithEmailAndPassword, 
    createUserWithEmailAndPassword, sendPasswordResetEmail, signOut,
    doc, getDoc, setDoc 
  };
</script>

  
</body>
</html>
